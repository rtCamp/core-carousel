:where(.carousel-kit) {
	position: relative;
	width: 100%;
	--carousel-kit-slide-width: 100%;
}

:where(.carousel-kit) .embla {
	overflow: hidden;
}

/* Ensure the default container and Query Loop list are flex rows */
:where(.carousel-kit) .embla__container,
:where(.carousel-kit) .embla .wp-block-post-template {
	display: flex;
	flex-wrap: nowrap;
	width: 100%;
	margin: 0;
	padding: 0;
	list-style: none;
	grid-template-columns: none;
	gap: var(--carousel-kit-gap, 0);
}

/* Ensure intermediate wrappers (like wp-block-query) don't shrink */
:where(.carousel-kit) .embla .wp-block-query {
	width: 100%;
	min-width: 100%;
}

/* Force slides (including posts) to respect a configurable width variable */
:where(.carousel-kit) .embla__slide,
:where(.carousel-kit) .embla .wp-block-post-template li {
	display: block;
	flex: 0 0 var(--carousel-kit-slide-width, 100%);
	width: var(--carousel-kit-slide-width, 100%);
	max-width: var(--carousel-kit-slide-width, 100%);
	min-width: 0;
	box-sizing: border-box;

	/* Reset margins by default (use gap instead) */
	margin-inline-end: 0;
	margin-block-start: 0;
	margin-block-end: 0;
}

/**
 * Fix for Embla Carousel Loop + Gap
 * When looping is enabled, Embla v8 doesn't support CSS 'gap'.
 * We switch to margin for consistent spacing in loop mode.
 */
:where(.core-carousel[data-loop="true"]) .embla__container,
:where(.core-carousel[data-loop="true"]) .embla .wp-block-post-template {
	gap: 0;
}

:where(.core-carousel[data-loop="true"]) .embla__slide,
:where(.core-carousel[data-loop="true"]) .embla .wp-block-post-template li {
	margin-inline-end: var(--core-carousel-gap, 0);
}

/* Vertical Axis adjustments */
:where(.carousel-kit[data-axis="y"]) {
	display: flex;
	flex-direction: column;
}

:where(.carousel-kit[data-axis="y"]) .embla {
	height: var(--carousel-kit-height);
}

:where(.carousel-kit[data-axis="y"]) .embla__container {
	flex-direction: column;
	height: 100%;
	min-height: 100%;
}

:where(.carousel-kit[data-axis="y"]) .embla__slide,
:where(.carousel-kit[data-axis="y"]) .embla .wp-block-post-template li {
	flex: 0 0 var(--carousel-kit-slide-width, 100%);
	width: 100%;
	max-width: 100%;
	margin-inline-end: 0;
}

/* Vertical + Loop specific */
:where(.core-carousel[data-axis="y"][data-loop="true"]) .embla__slide,
:where(.core-carousel[data-axis="y"][data-loop="true"]) .embla .wp-block-post-template li {
	margin-block-end: var(--core-carousel-gap, 0);
}
